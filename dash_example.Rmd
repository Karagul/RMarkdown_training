---
title: "Flights from New York City"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    theme: yeti
---

```{r setup, include=FALSE}
library(flexdashboard)
library(nycflights13)
library(ggplot2)
library(dplyr)
library(tidyr)
library(knitr)
```


Overview
=============================

Column {data-width=650}
-----------------------------------------------------------------------

### Top Destinations

```{r}
flights %>% group_by(dest, origin) %>%
	summarise(`Number of Departing Flights` = n()) %>%
	ungroup() %>% 
	spread(key = origin, value = `Number of Departing Flights`, fill = 0) %>% 
	arrange(desc(EWR + JFK + LGA)) %>%
	mutate(Destination = factor(dest, levels = rev(dest))) %>% 
	head(20) %>% 
	gather(key = 'Origin', value = `Number of Departing Flights`, EWR:LGA) %>%
	ggplot(aes(x = Destination, y = `Number of Departing Flights`, fill = Origin)) +
	geom_bar(stat = 'identity') + 
	coord_flip() + 
	theme_minimal() 
```

Column {data-width=350}
-----------------------------------------------------------------------

### Highest-Volume Carrier This Year

```{r}

top_carrier <- flights %>% 
	group_by(carrier) %>%
	summarise(n = n()) %>%
	arrange(desc(n)) %>%
	head(1) 

valueBox(value = paste0(top_carrier$carrier, ': ', prettyNum(top_carrier$n, big.mark = ','), ' flights.'))

```

### Most On-Time Major Carrier This Year

```{r}

on_time <- flights %>%
	group_by(carrier) %>%
	summarise(delay = mean(arr_delay, na.rm = T),
			  n = n()) %>%
	filter(n > 10000) %>%
	arrange(delay) %>%
	head(1)

valueBox(value = paste0(on_time$carrier, ': ', round(on_time$delay,1), ' min late'),color = 'success')

```

### Customer Experience

Kogi qui ex mixtape, placeat hashtag lomo cornhole asymmetrical hammock tofu. Magna VHS bicycle rights, butcher chillwave put a bird on it in tofu irony locavore ea occupy dreamcatcher hammock. Retro man braid etsy, banh mi pickled bitters XOXO drinking vinegar sunt. Heirloom culpa duis, ut letterpress four loko pug quis. Delectus everyday carry mlkshk, readymade pickled esse odio eiusmod cronut freegan bicycle rights chambray echo park pinterest occupy. Ethical seitan typewriter tousled, vinyl man braid fanny pack VHS sartorial YOLO man bun organic fingerstache. Et pinterest adipisicing, next level odio banh mi ennui tumblr proident ut direct trade.

- [A satisfied customer](http://hipsum.co/)

Managing Delays {.storyboard}
=============================

### Flights tend to be delayed most in the summer, suggesting that volume more than weather is the primary determinant of delays. 

```{r fig.width=10}

	flights %>% 
		group_by(month) %>%
		summarise(`Arrival` = mean(arr_delay, na.rm = T),
				  `Departure` = mean(dep_delay, na.rm = T),
				  n = n()) %>%
	mutate(month = month.name[month],
		   month = factor(month, levels = month)) %>%
		gather(key = `Arrival or Departure`, value = delay, Arrival:Departure) %>% 
		ggplot(aes(x = month, y = delay, color = `Arrival or Departure`, group = `Arrival or Departure`)) +
		geom_point() + 
		geom_path() + 
		theme_minimal() + 
		theme(axis.text.x=element_text(angle=90),
			  legend.title=element_blank()) +
	xlab('') + 
	ylab('Average (minutes)')
	
	

```

***
Est ut occupy williamsburg celiac XOXO. Deserunt selfies letterpress, poutine man bun brunch reprehenderit. Craft beer letterpress occupy voluptate reprehenderit veniam blog chicharrones banh mi brooklyn art party, VHS cronut polaroid you probably haven't heard of them. Ethical farm-to-table assumenda tousled, id hammock yuccie enim ad shoreditch offal marfa blue bottle brunch. Lomo placeat literally mumblecore four dollar toast fashion axe. Vero qui aliquip, blue bottle tattooed delectus before they sold out proident sriracha fap reprehenderit cliche deserunt direct trade. Vice id DIY crucifix affogato, schlitz sunt veniam mumblecore thundercats single-origin coffee freegan knausgaard.


### Flight delays are consistent by destination. 

```{r fig.width=10}


	flights %>% 
		group_by(carrier) %>%
	mutate(n = n()) %>% 
	filter(n > 20000) %>% 
	group_by(carrier, dest) %>%
		summarise(`Mean Delay` = mean(arr_delay, na.rm = T),
				  n = n()) %>%
	filter(n > 1000) %>% 
		ggplot(aes(y = carrier, x = dest, fill = `Mean Delay`)) +
		geom_tile() + 
		theme_minimal() + 
		theme(axis.text.x=element_text(angle=90)) + 
	xlab('Destination') + 
	ylab('Carrier')



```

***
Offal vegan PBR&B, seitan semiotics mumblecore labore sustainable before they sold out chambray sunt. Man braid organic PBR&B adipisicing, incididunt mlkshk selvage officia twee fixie pinterest yr +1 delectus. Irony leggings tacos normcore, gentrify XOXO poutine eiusmod ad squid blog. Post-ironic shabby chic authentic aesthetic you probably haven't heard of them dolore. Put a bird on it fap post-ironic helvetica, ut commodo humblebrag. Ea migas messenger bag, kickstarter bushwick aliqua commodo et kombucha. Nesciunt flexitarian banh mi, PBR&B squid yuccie magna irony assumenda.

